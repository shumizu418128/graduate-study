# OSRMå‡¦ç†æœ€é©åŒ–ãƒ„ãƒ¼ãƒ«

é–¢æ±åœ°æ–¹ã®OSMãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸOSRMï¼ˆOpen Source Routing Machineï¼‰ã®å‡¦ç†ã‚’æœ€é©åŒ–ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## ğŸš€ æœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ

- **å›ºå®šè¨­å®š**: å®‰å®šã—ãŸå‡¦ç†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–**: 24GBãƒ¡ãƒ¢ãƒªåˆ¶é™ã§é«˜é€Ÿå‡¦ç†
- **ã‚¹ãƒ¬ãƒƒãƒ‰æœ€é©åŒ–**: 4ã‚¹ãƒ¬ãƒƒãƒ‰ã§åŠ¹ç‡çš„ãªä¸¦åˆ—å‡¦ç†
- **è‡ªå‹•åŒ–**: æ‰‹å‹•ã‚³ãƒãƒ³ãƒ‰å…¥åŠ›ä¸è¦
- **å®‰å…¨æ€§**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ã

## ğŸ“‹ å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

- `kanto-latest.osm.pbf` - é–¢æ±åœ°æ–¹ã®OSMãƒ‡ãƒ¼ã‚¿
- `osrm_optimized.bat` - æœ€é©åŒ–ã•ã‚ŒãŸOSRMå‡¦ç†ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### æœ€é©åŒ–å‡¦ç†å®Ÿè¡Œ

```bash
osrm_optimized.bat
```

**å®Ÿè¡Œå†…å®¹:**
- ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆosrm-extractï¼‰
- ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ï¼ˆosrm-partitionï¼‰
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼ˆosrm-customizeï¼‰
- ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã®é¸æŠ

**å‡¦ç†ã®æµã‚Œ:**
1. é–‹å§‹æ™‚åˆ»ã®è¡¨ç¤º
2. å„æ®µéšã®å‡¦ç†å®Ÿè¡Œ
3. ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
4. å®Œäº†æ™‚åˆ»ã®è¡¨ç¤º
5. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã®é¸æŠ

## âš¡ è¨­å®šä»•æ§˜

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| ãƒ¡ãƒ¢ãƒªåˆ¶é™ | 24GB |
| ã‚¹ãƒ¬ãƒƒãƒ‰æ•° | 4 |
| ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | MLDï¼ˆMulti-Level Dijkstraï¼‰ |

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### è¨­å®šå€¤ã®å¤‰æ›´

`osrm_optimized.bat` ã®ä»¥ä¸‹ã®è¡Œã‚’ç·¨é›†ï¼š

```batch
docker run -t -v "D:\21EH_shimizu\graduate-study:/data" --memory=24g osrm/osrm-backend osrm-extract -p /opt/car.lua --threads 4 /data/kanto-latest.osm.pbf
```

### æ³¨æ„äº‹é …

- ãƒ¡ãƒ¢ãƒªåˆ¶é™ã¯åˆ©ç”¨å¯èƒ½ãƒ¡ãƒ¢ãƒªã®80%ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„
- SSDä½¿ç”¨æ™‚ã¯ç‰¹ã«åŠ¹æœçš„ã§ã™
- åˆå›å®Ÿè¡Œæ™‚ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ãŒã€2å›ç›®ä»¥é™ã¯é«˜é€ŸåŒ–ã•ã‚Œã¾ã™

## ğŸ“ ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

å‡¦ç†å®Œäº†å¾Œã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼š

- `kanto-latest.osrm` - ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«
- `kanto-latest.osrm.cell_metrics` - ã‚»ãƒ«ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- `kanto-latest.osrm.cells` - ã‚»ãƒ«ãƒ‡ãƒ¼ã‚¿
- `kanto-latest.osrm.cnbg` - ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒãƒ¼ãƒ‰
- `kanto-latest.osrm.cnbg_to_ebg` - ãƒãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°
- `kanto-latest.osrm.datasource_names` - ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å
- `kanto-latest.osrm.ebg` - ã‚¨ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚°ãƒ©ãƒ•
- `kanto-latest.osrm.ebg_nodes` - ã‚¨ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ãƒ‰
- `kanto-latest.osrm.edges` - ã‚¨ãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿
- `kanto-latest.osrm.enw` - ã‚¨ãƒƒã‚¸ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¤
- `kanto-latest.osrm.fileIndex` - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- `kanto-latest.osrm.geometry` - ã‚¸ã‚ªãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿
- `kanto-latest.osrm.icd` - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- `kanto-latest.osrm.maneuver_overrides` - ãƒãƒ‹ãƒ¥ãƒ¼ãƒã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
- `kanto-latest.osrm.mldgr` - MLDã‚°ãƒ©ãƒ•
- `kanto-latest.osrm.names` - åå‰ãƒ‡ãƒ¼ã‚¿
- `kanto-latest.osrm.nbg_nodes` - ãƒãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚°ãƒ©ãƒ•ãƒãƒ¼ãƒ‰
- `kanto-latest.osrm.partition` - ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³
- `kanto-latest.osrm.properties` - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
- `kanto-latest.osrm.ramIndex` - RAMã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- `kanto-latest.osrm.restrictions` - åˆ¶é™ãƒ‡ãƒ¼ã‚¿
- `kanto-latest.osrm.timestamp` - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- `kanto-latest.osrm.tld` - ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«
- `kanto-latest.osrm.tls` - ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã‚»ãƒƒãƒˆ
- `kanto-latest.osrm.turn_duration_penalties` - ã‚¿ãƒ¼ãƒ³æ™‚é–“ãƒšãƒŠãƒ«ãƒ†ã‚£
- `kanto-latest.osrm.turn_penalties_index` - ã‚¿ãƒ¼ãƒ³ãƒšãƒŠãƒ«ãƒ†ã‚£ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- `kanto-latest.osrm.turn_weight_penalties` - ã‚¿ãƒ¼ãƒ³é‡ã¿ãƒšãƒŠãƒ«ãƒ†ã‚£

## ğŸŒ ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

å‡¦ç†å®Œäº†å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã§ãã¾ã™ï¼š

```bash
docker run -t -i -p 5000:5000 -v "D:\21EH_shimizu\graduate-study:/data" --memory=8g osrm/osrm-backend osrm-routed --algorithm mld --threads 4 /data/kanto-latest.osrm
```

**ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•:**
- URL: `http://localhost:5000`

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼**
   - ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã—ã¦ãã ã•ã„
   - ã‚·ã‚¹ãƒ†ãƒ ã®åˆ©ç”¨å¯èƒ½ãƒ¡ãƒ¢ãƒªã‚’ç¢ºèªã—ã¦ãã ã•ã„

2. **Dockerã‚¨ãƒ©ãƒ¼**
   - Docker DesktopãŒèµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„
   - ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒååˆ†ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„

### ãƒ­ã‚°ã®ç¢ºèª

ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
- Docker ãƒ­ã‚°
- ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°
- ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
1. ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶ã®ç¢ºèª
2. Dockerç’°å¢ƒã®ç¢ºèª
3. ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã®ç¢ºèª
4. ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç¢ºèª
